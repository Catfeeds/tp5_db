<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>layui分页</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    {load file="__STATIC__/layui/layui.all.js"}
    {load file="__STATIC__/layui/css/layui.css"}
    {load file="__STATIC__/js/jquery-3.2.1.min.js"}
</head>
<body>
<div id="pTable" style="width: 1200px;">
    <table class="layui-table" id="layui_table_id" lay-filter="test">
    </table>
    <div id="laypage"></div>

</div>
<script>
    var limitcount = 10;
    var curnum = 1;
    //列表查询方法
    function productsearch(productGroupId,start,limitsize) {
        layui.use(['table','laypage','laydate'], function(){
            var table = layui.table,
                laydate=layui.laydate,
                laypage = layui.laypage;
            table.render({
                elem: '#layui_table_id'
                , url: "{:url('test/ajaxpage')}"
                , where:{pagename:start,pagelimit:limitsize} //传参*/
                , cols: [[
                    {field: 'uid', title: 'ID', width: '170', sort: true}
                    , {field: 'username', title: '名称', width: '450'}
                    , {field: 'password', title: '状态', width: '100'}
                    , {field: 'realname', title: '生效时间', width: '120', sort: true}
                    , {field: 'lastloginip', title: '失效时间', width: '120', sort: true}
                    , {field: 'ppassword', title: '成本', width: '100', sort: true}
                    , {field: 'poperation', title: '操作', width: '100',fixed: 'right', toolbar: '#barDemo'}
                ]]
                , page: false
                , height: 430
                ,done: function({data:{$list},count:{$count}}, curr, count){
                    //如果是异步请求数据方式，res即为你接口返回的信息。
                    //如果是直接赋值的方式，res即为：{data: [], count: 99} data为当前页数据、count为数据总长度
                    laypage.render({
                        elem:'laypage'
                        ,count:count
                        ,curr:curnum
                        ,limit:limitcount
                        ,layout: ['prev', 'page', 'next', 'skip','count','limit']
                        ,jump:function (obj,first) {
                            if(!first){
                                curnum = obj.curr;
                                limitcount = obj.limit;
                                //console.log("curnum"+curnum);
                                //console.log("limitcount"+limitcount);
                                //layer.msg(curnum+"-"+limitcount);
                                productsearch(productGroupId,curnum,limitcount);
                            }
                        }
                    })
                }
            })

            //监听工具条
            table.on('tool(test)', function(obj){ //注：tool是工具条事件名，test是table原始容器的属性 lay-filter="对应的值"
                var data = obj.data //获得当前行数据
                    ,layEvent = obj.event; //获得 lay-event 对应的值
                if(layEvent === 'detail'){
                    viewLableInfo(data.attrId);
                    layer.msg(data.attrId);
                } else if(layEvent === 'del'){
                    layer.msg('删除');
                } else if(layEvent === 'edit'){
                    layer.msg('编辑操作');
                }
            });
            //常规用法
            laydate.render({
                elem: '#createDate'
            });
            //常规用法
            laydate.render({
                elem: '#processingTime'
            });

        });
    }
    var pId = '${pGBean.pgId }';
    productsearch(pId, curnum, limitcount);

</script>

</body>
</html>